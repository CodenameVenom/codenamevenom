<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>codenamevenom — Security Portfolio</title>
  <meta name="description" content="Technical portfolio of accepted and paid security reports — codenamevenom" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f12;--card:#0f1620;--muted:#98a0aa;--accent:#ef4444;--glass:rgba(255,255,255,0.03);
      --text:#e6eef6;--light-bg:#f5f5f5;--light-card:#ffffff;--light-text:#222;--light-muted:#666
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:var(--text);background:var(--bg);overflow-x:hidden;display:flex;transition:background .3s,color .3s;min-height:100vh;flex-direction:row}
    body.light{background:var(--light-bg);color:var(--light-text)}

    /* sidebar */
    #sidebar{width:260px;min-height:100vh;background:#0f1620;display:flex;flex-direction:column;align-items:center;padding:30px 20px;box-shadow:4px 0 20px rgba(0,0,0,0.6);position:fixed;left:0;top:0;bottom:0;transition:background .3s}
    body.light #sidebar{background:#fff}
    #sidebar h2{margin-top:16px;font-size:20px;letter-spacing:1px;text-transform:uppercase;transition:color .3s, text-shadow .3s}
    #sidebar h2:hover{color:var(--accent);text-shadow:0 0 8px var(--accent)}
    #sidebar p{color:var(--muted);font-size:13px;margin-top:4px;text-align:center}
    #sidebar ul{list-style:none;margin-top:30px;width:100%}
    #sidebar ul li{margin:10px 0}
    #sidebar ul li a{color:inherit;text-decoration:none;display:flex;align-items:center;gap:10px;padding:10px;border-radius:8px;transition:background 0.3s}
    #sidebar ul li a:hover{background:rgba(239,68,68,0.1);color:var(--accent)}

    .sidebar-bottom{margin-top:auto;display:flex;gap:12px;align-items:center}
    .circle-icon{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#1c2530;color:#aaa;cursor:pointer;transition:all .25s;font-size:18px}
    .circle-icon:hover{color:#fff;background:var(--accent)}
    body.light .circle-icon{background:#ddd;color:#444}

    /* avatar (loop symbol), pulse on load then static, animates only on hover */
    .avatar-wrapper {
      position: relative;
      width: 120px;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
    }
    .avatar-circle {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle at 50% 50%, rgba(239,68,68,0.35), transparent 70%);
      border: 3px solid var(--accent);
      box-shadow: 0 0 12px rgba(239,68,68,0.4);
      transition: transform .6s ease, box-shadow .6s ease;
    }
    .avatar-symbol {
      z-index: 2;
      font-size: 44px;
      color: var(--text);
      transition: transform .5s ease, color .5s ease;
      animation: pulse 1.2s ease-out 1; /* pulso iniziale */
    }
    .avatar-wrapper:hover .avatar-circle {
      transform: rotate(360deg) scale(1.06);
      box-shadow: 0 0 26px rgba(239,68,68,0.85);
    }
    .avatar-wrapper:hover .avatar-symbol {
      transform: scale(1.28) rotate(18deg);
      color: var(--accent);
      animation: none; /* evita ripetizione */
    }
    @keyframes pulse {
      0%   { transform: scale(0.9); opacity: 0.7; }
      50%  { transform: scale(1.15); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }


    /* content */
    #content{margin-left:260px;flex:1;padding:30px;max-width:calc(100% - 260px);display:flex;flex-direction:column;min-height:100vh}
    section{display:none;animation:fade .5s ease;flex:1}
    section.active{display:block}
    @keyframes fade{from{opacity:0}to{opacity:1}}

    /* home cards stacked + centered */
    .stack{display:flex;flex-direction:column;align-items:center;gap:60px;margin-top:40px}
    .card{width:70%;background:var(--card);border-radius:14px;padding:20px;box-shadow:0 0 16px rgba(239,68,68,0.08);border:1px solid rgba(255,255,255,0.04);transition:transform 0.28s ease, box-shadow 0.28s ease, background .3s;cursor:pointer}
    .card:hover{transform:translateY(-6px);box-shadow:0 18px 60px rgba(239,68,68,0.14);background:rgba(239,68,68,0.05)}
    body.light .card{background:var(--light-card);color:var(--light-text)}

    /* reports collapsible (minimal, GoDiego-style) */
    .folder{background:var(--card);margin-bottom:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.05)}
    .folder-header{padding:12px;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px}
    .folder-header:hover{background:rgba(239,68,68,0.08)}
    .folder-content{display:none;padding:0 18px 12px 18px}
    .folder-content ul{list-style:none;padding-left:0}
    .folder-content li{margin:6px 0;font-size:14px;color:var(--muted)}
    .folder-content a{color:inherit;text-decoration:none}
    .folder-content a:hover{color:var(--accent)}
    body.light .folder{background:var(--light-card)}

    /* about me */
    #about h2{font-family:Georgia,serif;font-size:26px;color:#e6eef6;margin-bottom:10px}
    #about p.intro{font-family:Georgia,serif;font-size:18px;color:#9bb0c8;margin-bottom:20px;min-height:30px}
    #about ul{list-style:disc;margin-left:20px;color:var(--muted)}
    body.light #about h2{color:#222}

    /* contact */
    #contact a{color:inherit;font-size:16px;text-decoration:none}
    #contact a:hover{color:var(--accent)}

    footer{text-align:center;color:var(--muted);font-size:13px;padding:20px;margin-top:auto}
  </style>
</head>
<body>
  <aside id="sidebar">
    <div class="avatar-wrapper" title="codenamevenom">
      <div class="avatar-circle"></div>
      <div class="avatar-symbol">⟳</div>
    </div>
    <h2>CODENAMEVENOM</h2>
    <p>Cybersecurity Engineer · Offensive Researcher</p>
    <ul>
      <li><a href="#home" onclick="return showSection('home')"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="#reports" onclick="return showSection('reports')"><i class="fa fa-list"></i> Reports</a></li>
      <li><a href="#about" onclick="return showSection('about')"><i class="fa fa-user"></i> About Me</a></li>
      <li><a href="#contact" onclick="return showSection('contact')"><i class="fa fa-envelope"></i> Contact</a></li>
    </ul>
    <div class="sidebar-bottom">
      <div id="mode-toggle" class="circle-icon" title="Toggle theme"><i class="fa fa-moon"></i></div>
      <a href="mailto:voxlab.services@gmail.com" class="circle-icon" title="Email"><i class="fa fa-envelope"></i></a>
    </div>
  </aside>

  <main id="content">
    <section id="home" class="active">
      <header data-aos="fade-down">
        <h1>Security Portfolio — Accepted & Paid Reports</h1>
        <p style="color:var(--muted)">Selection of anonymized reports demonstrating offensive security findings and impact.</p>
      </header>
      <div class="stack">
        <div class="card" data-aos="fade-up" onclick="openReport('ssrf')"><h3>SSRF — /api/og/statistic</h3><p>Parameter allowed internal network discovery via SSRF.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('idor1')"><h3>IDOR — /api/Log</h3><p>Exposed unauthorized resources through weak access control.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('logic')"><h3>Business Logic — Weak Email Validation</h3><p>Allowed automation and abuse of workflow.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('access')"><h3>Improper Access Control — /register</h3><p>Registration endpoint abused without authorization.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('xss')"><h3>DOM XSS — /user/auth/chooseschema</h3><p>Reflected DOM injection led to XSS.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('idor2')"><h3>IDOR — /api/quotes/[UUID]/</h3><p>Predictable UUID exposed other users' data.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('idor3')"><h3>IDOR — /v2/apps/[ID]/verification-methods</h3><p>Endpoint leaked verification methods of other users.</p></div>
      </div>
      <footer>© 2025 codenamevenom — All rights reserved</footer>
    </section>

    <section id="reports">
      <h2>Reports by Category</h2>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> SSRF</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('ssrf')">/api/og/statistic — Internal network SSRF</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> IDOR</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('idor1')">/api/Log — Exposed unauthorized resources</a></li><li><a href="#" onclick="openReport('idor2')">/api/quotes/[UUID]/ — Predictable identifier leak</a></li><li><a href="#" onclick="openReport('idor3')">/v2/apps/[ID]/verification-methods — Leaked user verification methods</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> XSS</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('xss')">/user/auth/chooseschema — DOM-based XSS</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> Business Logic</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('logic')">Weak Email Validation — Workflow abuse</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> Access Control</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('access')">/api/auth/local/register — Unauthorized registration</a></li></ul></div></div>
      <footer>© 2025 codenamevenom — All rights reserved</footer>
    </section>

    <section id="about">
      <h2>About Me</h2>
      <p class="intro" id="particleText"></p>
      <h3>Who am I?</h3>
      <ul>
        <li>Offensive Cybersecurity Researcher</li>
        <li>STEM Graduate</li>
        <li>eJPT holder, successfully achieved</li>
        <li>Currently preparing for OSCP</li>
      </ul>
      <footer>© 2025 codenamevenom — All rights reserved</footer>
    </section>

    <section id="contact">
      <h2>Contact</h2>
      <p><a href="mailto:voxlab.services@gmail.com">voxlab.services@gmail.com</a></p>
      <footer>© 2025 codenamevenom — All rights reserved</footer>
    </section>

    <section id="report-detail" aria-live="polite">
  <div style="max-width:900px;margin:0 auto;padding:20px;">
    <h2 id="report-title">Report Title</h2>
    <div id="report-body">
      <p><strong>Summary:</strong> A server-side request forgery (SSRF) was discovered in an unauthenticated endpoint responsible for generating Open Graph images. The endpoint allowed arbitrary user-supplied URLs via the <code>image</code> GET parameter, which were fetched server-side and returned as a PNG. Due to the lack of input validation and network egress control, this resulted in a full SSRF primitive with deep internal reconnaissance capabilities.</p>

      <h3>🧠 Core Behaviors</h3>
      <ul>
        <li>Arbitrary external/internal URL fetching (unauthenticated)</li>
        <li>Followed HTTP redirects (302, 301)</li>
        <li>Synchronous blocking — remote response delays impacted backend response time</li>
        <li>Attacker-controlled content cached under application domain for 1 year</li>
        <li>Access to <code>169.254.169.254</code> (Instance Metadata Service)</li>
        <li><strong>Ability to scan internal IPs and discover open ports</strong></li>
      </ul>

      <h3>🔍 Internal Network Discovery</h3>
      <pre><code>for ip in 10.0.0.1 to 10.0.0.255:
  for port in [80,443,8080,8000,5000,3000]:
    image = f"http://{ip}:{port}/favicon.ico"
    response = GET /api/og/statistic?image={image}
    if HTTP 200 or non-empty PNG:
        log live host and port
    elif delay > 5s:
        mark as open|filtered</code></pre>

      <h3>🧨 IMDS Access</h3>
      <p>Direct access to the Instance Metadata Service (<code>169.254.169.254</code>) was confirmed:</p>
      <ul>
        <li><code>/latest/meta-data/</code> → 200 OK</li>
        <li><code>/latest/meta-data/instance-id</code> → valid instance ID</li>
        <li><code>/latest/meta-data/iam/security-credentials/</code> → accessible</li>
      </ul>

      <h3>🧪 PoC Examples</h3>
      <pre><code>curl -i 'https://target/api/og/statistic?image=https://attacker.oast.pro/poc.png'</code></pre>
      <pre><code>curl -i 'https://target/api/og/statistic?image=http://169.254.169.254/latest/meta-data/'</code></pre>

      <h3>🎯 Impact</h3>
      <ul>
        <li><strong>Full SSRF</strong> with internal IP scan</li>
        <li><strong>IMDS access</strong> → possible credential leak</li>
        <li><strong>Persistent cache</strong> of attacker-controlled resources</li>
        <li><strong>DoS</strong> via delayed responses</li>
      </ul>

      <h3>🛡 Recommended Remediation</h3>
      <ul>
        <li>Denylist/allowlist outbound requests</li>
        <li>Block private IP ranges</li>
        <li>Use async + timeouts</li>
        <li>Enable IMDSv2</li>
      </ul>
    </div>
  </div>
  <footer>© 2025 codenamevenom — All rights reserved</footer>
</section>

  </main>

  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({duration:700, once:false, offset:100});

    function showSection(id){
      document.querySelectorAll('main section').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if(id==='about'){particleEffect();}
      return false;
    }

    function toggleFolder(header){
      const c=header.nextElementSibling;
      c.style.display = c.style.display==='block' ? 'none' : 'block';
    }

    document.getElementById('mode-toggle').onclick=function(){
      document.body.classList.toggle('light');
      this.innerHTML = document.body.classList.contains('light') ? '<i class="fa fa-sun"></i>' : '<i class="fa fa-moon"></i>';
    };

    function particleEffect(){
      const el=document.getElementById('particleText');
      const text="Driven by curiosity, I explore systems to strengthen their security while continuously learning.";
      if(!el) return;
      el.innerHTML='';
      [...text].forEach((ch,i)=>{
        const span=document.createElement('span');
        span.textContent= ch===' ' ? '\u00A0' : ch;
        span.style.opacity=0;
        span.style.display='inline-block';
        span.style.filter='blur(6px)';
        span.style.transform='translateY(6px)';
        span.style.transition=`opacity 0.35s ${i*40}ms, filter 0.35s ${i*40}ms, transform 0.35s ${i*40}ms`;
        el.appendChild(span);
      });
      requestAnimationFrame(()=>{
        el.querySelectorAll('span').forEach(s=>{s.style.opacity=1;s.style.filter='blur(0)';s.style.transform='translateY(0)';});
      });
    }

    function safeInjectReport(containerId, htmlContent) {
  const container = document.getElementById(containerId);
  if (!container) {
    console.error('Container not found:', containerId);
    return;
  }

  // Rimuovi eventuali tag <script> per sicurezza (basic)
  const stripped = String(htmlContent).replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi, '');

  // Inietta HTML sanitizzato (basic). Se vuoi maggiore sicurezza, integra DOMPurify.
  container.innerHTML = stripped;

  // Refresh AOS (se usi AOS)
  if (window.AOS && typeof AOS.refresh === 'function') {
    AOS.refresh();
  }

  // Prism highlight (se usi Prism)
  requestAnimationFrame(() => {
    if (window.Prism && typeof Prism.highlightAll === 'function') {
      Prism.highlightAll();
    }
  });
}



    function openReport(id){
  // Nascondi tutte le sezioni e mostra report-detail
  document.querySelectorAll('main section').forEach(s => s.classList.remove('active'));
  const reportSection = document.getElementById('report-detail');
  if(!reportSection) return false;
  reportSection.classList.add('active');

  const titleMap = {
    ssrf: "SSRF — /api/og/statistic",
    idor1: "IDOR — /api/Log",
    logic: "Business Logic — Weak Email Validation",
    access: "Improper Access Control — /register",
    xss: "DOM XSS — /user/auth/chooseschema",
    idor2: "IDOR — /api/quotes/[UUID]/",
    idor3: "IDOR — /v2/apps/[ID]/verification-methods"
  };

  // riferimenti fissi
  const titleEl = document.getElementById('report-title');
  const bodyEl  = document.getElementById('report-body');

  if(titleEl) titleEl.textContent = titleMap[id] || "Report";

  // SSRF: se il tuo HTML SSRF è già statico dentro #report-body, lascialo così
  if(id === 'ssrf'){
    // non sovrascrivere (se vuoi, qui puoi forzare l'overwrite)
  }

  // IDOR: iniettiamo il post completo (body only)
  else if (id === 'idor1') {
    if (!bodyEl) return false;
    const reportHtml = `
<div id="post-wrapper">
  <h1>IDOR Exploitation: Breaking Access Control in Action Logging</h1>
  <div class="post-meta text-muted">
    <span>Posted in <em>Offensive Security Research</em> · CVSS: <strong>High</strong></span>
  </div>

  <div class="post-content">
    <blockquote>
      <p>
        This article walks through a real-world penetration test finding: an Insecure Direct Object Reference (IDOR) in an action logging endpoint. 
        The case study highlights the importance of thorough mapping during pre-engagement, exploration of business logic paths, and the use of custom Python tooling to validate impact without touching third-party data.
      </p>
    </blockquote>

    <h2>Pre-Engagement: Mapping the Landscape</h2>
    <p>
      Every serious penetration test begins with reconnaissance. Before testing functionality, I invested time in mapping the endpoints exposed by the target system, comparing traffic flows against baseline expectations. 
      This mapping phase was crucial: it revealed patterns in action logging calls, including parameters that appeared sequential and predictable.
    </p>

    <h2>Exploration and Discovery</h2>
    <p>
      During exploration, I identified a logging endpoint responsible for tracking user actions. 
      The request body included an <code>id</code> parameter, which appeared to reference user membership or session identifiers. 
      Surprisingly, the server accepted arbitrary values without checking whether they belonged to the authenticated account.
    </p>

    <h2>Endpoint Behavior</h2>
    <pre><code>
POST /api/log?actionTag=send-invite
Body:
{
  "id": "100245",
  "actionTag": "send-invite",
  "metadata": { "origin": "personalArea" }
}
    </code></pre>

    <p>
      Regardless of ownership, the backend responded with:
    </p>
    <pre><code>
HTTP/2 200 OK
true
    </code></pre>

    <p>
      Non-authenticated requests correctly returned <code>403 Forbidden</code>, but authenticated requests with arbitrary IDs were always accepted.
    </p>

    <h2>Custom Python Tooling</h2>
    <p>
      To test this in a controlled and ethical manner, I developed a custom Python script. 
      The script attached to the browser via the Chrome DevTools Protocol, extracted my own valid JWT token and session cookies, and replayed the request sequence with manipulated IDs. 
      Instead of accessing or modifying third-party data, the script merely checked for <code>true</code> vs <code>false</code> responses. 
      This approach made it possible to systematically confirm the vulnerability while staying within scope and policy.
    </p>

    <pre><code class="language-python">
if r.status_code == 200 and "true" in r.text.lower():
    print(f"[VULNERABLE] id={test_id} accepted")
    </code></pre>

    <h2>Escalation Through Enumeration</h2>
    <p>
      Once the flaw was confirmed, I demonstrated how enumeration could escalate the issue. 
      By iterating over sequential <code>id</code> values, any logged-in user could inject spoofed actions tied to other accounts. 
      This does not expose personal data directly, but it pollutes the system’s business logic, audit trails, and potential reward mechanisms.
    </p>

    <h2>Business Impact</h2>
    <ul>
      <li>Audit records can be artificially manipulated</li>
      <li>Referral or incentive systems can be fraudulently triggered</li>
      <li>Authorization boundaries are broken at the API level</li>
      <li>Large-scale automated exploitation possible via ID enumeration</li>
    </ul>

    <h2>Why This Matters</h2>
    <p>
      Even without sensitive data leakage, this IDOR is significant. 
      Security is not only about protecting confidentiality but also about ensuring the integrity of business workflows. 
      Allowing unauthorized users to influence system logs or rewards undermines trust in the platform itself.
    </p>

    <h2>Mitigation Recommendations</h2>
    <ul>
      <li>Enforce strict server-side ownership validation for all identifiers</li>
      <li>Reject mismatched <code>id</code> values with <code>403 Forbidden</code></li>
      <li>Tie resource validation directly to authenticated user session IDs</li>
      <li>Apply defense-in-depth: log anomalies and enforce rate limits on action logging</li>
    </ul>

    <h2>Ethical Note</h2>
    <p>
      The testing was performed responsibly using my own account and credentials only. 
      No third-party data was accessed, extracted, or altered. 
      The purpose of this exploration was to highlight the weakness in access control logic and demonstrate safe validation practices.
    </p>
  </div>
</div>
    `;
  
     safeInjectReport('report-body', reportHtml);
  }
  // --- template placeholder per altri report ---
    else if (id === 'logic') {
    if (!bodyEl) return false;
    const reportHtml = `<!-- START REPORT HTML -->
<!-- START REPORT HTML (anonymized, styled for Prism) -->
<h2>Weak Email Validation & Lack of Anti-Automation Controls (Business Logic Flaw)</h2>
<div id="report-body-inner">
  <p><strong>Summary:</strong> During a security assessment of a public newsletter subscription API, I identified weak server-side email validation coupled with the absence of anti-automation controls. Two advanced obfuscated payloads bypassed validation and were accepted with <code>200 OK</code>, while the API allowed high-volume submissions without rate-limiting or bot mitigation. The combination enables dataset poisoning, large-scale automated abuse and downstream failures in systems that assume valid email inputs.</p>

  <div class="post-meta"><strong>Context:</strong> CVSS: <strong>High</strong> — Anonymous disclosure / responsible testing.</div>

  <h3>Pre-Engagement & Mapping</h3>
  <p>Before any active testing, I performed systematic mapping of the public surface: enumerated endpoints, compared request/response patterns from the client application, and identified the public newsletter subscribe endpoint. The mapping phase highlighted a simple JSON API that accepted an email field and returned straightforward success/failure semantics. Understanding this surface was essential to design non-destructive tests and to constrain actions to in-scope behavior.</p>

  <h3>Exploration & Discovery</h3>
  <p>Initial tests showed most malformed inputs were rejected with <code>400/403</code> or similar. However, two obfuscation techniques — URL-encoded payloads containing encoded markup characters — were accepted and returned success. The endpoint also exhibited no enforcement of rate limits, no CAPTCHA, and no verification step (e.g. double opt-in), enabling automated submissions at scale.</p>

  <h3>Endpoint Behaviour (anonymized)</h3>
  <pre><code class="language-bash">
POST https://&lt;media-host&gt;/api/newsletter/subscribe
Body:
{ "email": "&lt;payload&gt;" }
  </code></pre>

  <p>Observed response for bypassing payloads:</p>
  <pre><code class="language-bash">
HTTP/2 200 OK
{ "status": "subscribed" }
  </code></pre>

  <h3>Bypassing Payloads (tested)</h3>
  <p>The following encoded payloads were accepted by the server during testing. They demonstrate that the validation logic can be evaded by URL encoding and subaddressing tricks:</p>
  <ul>
    <li><code>%22%3E%3Csvg%2Fonload%3Dalert(1)%3E%22@example.com</code></li>
    <li><code>test+%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(1)%3E@example.com</code></li>
  </ul>
  <p>These inputs include encoded characters that, when decoded or rendered downstream (e.g. in dashboards, previews or webhooks), could produce injection effects or break downstream parsers.</p>

  <h3>Proof of Concept — Controlled, Non-Destructive</h3>
  <p>To validate the issue ethically, I implemented several small Python scripts that demonstrate two attack patterns while avoiding destructive behavior or accessing third-party data:</p>

  <h4>PoC 1 — Filter bypass & mass submission</h4>
  <p>Logic summary:</p>
  <ol>
    <li>Construct a set of obfuscated email payloads (encoded XSS-like strings appended to a valid domain).</li>
    <li>POST each payload to the subscribe endpoint with standard headers.</li>
    <li>Log responses: accept (200) vs blocked (400/422/403).</li>
    <li>Throttle requests to avoid accidental service disruption (e.g. 0.3–0.5s delay in tests).</li>
  </ol>
  <p>Outcome: multiple encoded payloads were accepted as valid subscriptions. The script intentionally does not attempt to read or modify existing records — it only verifies acceptance semantics.</p>

  <h4>PoC 2 — Oracle enumeration via response-based behaviour</h4>
  <p>Logic summary:</p>
  <ol>
    <li>Create crafted variants of known email addresses (subaddressing, encoded suffixes).</li>
    <li>POST a crafted address and observe the response code/behavior.</li>
    <li>Resend or repeat requests to infer storage/deduplication and acceptance behavior.</li>
  </ol>
  <p>Outcome: differences in response codes and timings allow an attacker to build an oracle that infers whether certain addresses are stored, accepted, deduplicated or processed — enabling large-scale enumeration and verification attacks.</p>

  <h3>Automation & Evasion Techniques</h3>
  <p>The environment lacked effective anti-automation controls. In practical abuse scenarios an attacker can combine:</p>
  <ul>
    <li>IP rotation (VPNs, proxy pools)</li>
    <li>User-Agent randomization and fingerprint spoofing</li>
    <li>Cookie reuse from publicly available sessions</li>
    <li>Parallelized submission workers</li>
  </ul>
  <p>Without rate-limiting or per-session constraints, this allows high-volume injection of malformed or malicious entries into the system.</p>

  <h3>Attack Scenarios & Business Impact</h3>
  <ul>
    <li><strong>Data poisoning:</strong> Invalid or malicious entries propagate to third-party providers (mailing platforms, CRMs, analytics), degrading data quality.</li>
    <li><strong>Downstream failures:</strong> Batch processing, CSV exports, or email delivery systems may error on unexpected formats.</li>
    <li><strong>GDPR & privacy risk:</strong> Uncurated lists increase the surface for privacy issues and regulatory exposure.</li>
    <li><strong>Reputational damage:</strong> Malicious payloads stored under the platform’s domain can be used for brand abuse or phishing campaigns.</li>
    <li><strong>Enumeration & verification:</strong> The oracle technique enables scalable validation of target email lists, facilitating targeted abuse.</li>
  </ul>

  <h3>Severity Rationale</h3>
  <p>Although the vulnerability does not directly disclose sensitive fields, the combination of persistent storage of attacker-controlled data, absence of mitigation (CAPTCHA, rate limits, double opt-in), and oracle-style response mechanics justifies a <strong>High</strong> severity classification. The risk grows substantially when leveraged at scale and in conjunction with other weaknesses (e.g. weak downstream sanitization).</p>

  <h3>Recommended Mitigations</h3>
  <ul>
    <li><strong>Strict server-side validation:</strong> Enforce RFC-compliant email validation and reject encoded or control characters that deviate from canonical forms.</li>
    <li><strong>Input normalization:</strong> Decode, normalize and canonicalize incoming addresses before validation and storage (strip control chars, percent-encoded markup, subaddressing when not required).</li>
    <li><strong>Rate limiting:</strong> Apply per-IP, per-cookie and per-account throttling. Consider progressive backoff and challenge thresholds.</li>
    <li><strong>Anti-automation:</strong> Implement CAPTCHA or equivalent bot detection on public subscription endpoints, especially for high-volume flows.</li>
    <li><strong>Double opt-in:</strong> Require verification via email confirmation before storing addresses in production lists or forwarding to third-party services.</li>
    <li><strong>Downstream audit:</strong> Review all systems consuming the mailing list (CRMs, analytics, webhooks) to ensure they sanitize inputs and handle unexpected formats safely.</li>
    <li><strong>Logging & alerting:</strong> Add anomaly detection for spikes in subscription rates or unusual payload patterns; log sanitized and raw inputs for triage.</li>
  </ul>

  <h3>Detection & Hardening Guidance</h3>
  <p>For triage teams: create a monitoring rule that flags:</p>
  <ul>
    <li>HTML or URL-encoded characters in the local part of addresses</li>
    <li>High rate of subscriptions per IP or per session</li>
    <li>Repeated acceptance of payloads containing markup characters</li>
  </ul>

  <h3>Ethical Testing Note</h3>
  <p>All tests were conducted in a controlled, non-destructive manner using my own test inputs and accounts where required. No third-party user data was accessed, modified or exfiltrated. Scripts used for validation confirm acceptance semantics only and intentionally avoid destructive operations.</p>

  <h3>Appendix — Safe PoC Patterns (conceptual)</h3>
  <p>The following pseudo-code represents the safe testing approach used (no live domains are included):</p>
  <pre><code class="language-bash">
payloads = [
  "%22%3E%3Csvg%2Fonload%3Dalert(1)%3E%22@example.com",
  "test+%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(1)%3E@example.com"
]

for p in payloads:
  resp = POST "https://&lt;media-host&gt;/api/newsletter/subscribe" with json {"email": p}
  log(p, resp.status_code, resp.body_summary)
  sleep(0.3)  # throttled for safety
  </code></pre>

  <p>Use caution: when converting these patterns to real tests, throttle aggressively and avoid publishing or sharing any real user data.</p>

  <footer>Report prepared by a security researcher — responsible disclosure applied. © 2025</footer>
</div>
<!-- END REPORT HTML -->`;
       safeInjectReport('report-body', reportHtml);
  }


  // fallback per gli altri report (placeholder)
  else {
    if (!bodyEl) return false;
    bodyEl.innerHTML = `
      <div style="max-width:900px;margin:0 auto;padding:20px;">
        <h3>${titleMap[id] || id}</h3>
        <p>Detailed content for <strong>${titleMap[id] || id}</strong> will be added here.</p>
      </div>
    `;
  }

  // scroll top per visibilità
  window.scrollTo({ top: 0, behavior: 'smooth' });
  return false;
}



    // Initialize About text if About is default (not the case now, but safe)
    if(document.getElementById('about').classList.contains('active')){ particleEffect(); }
  </script>
</body>
</html>
